System.register("chunks:///legend-slot.js",["./LegendSlotCoinWin.view-e6f13b36.js","cc","./TweenHelper-b35a04c2.js","./CoreModelEvent-3de9f67c.js","./SlotBaseView-556c9046.js"],(function(){"use strict";var t,e,n,i,o,r,s,a,l,u,h,c,p,_,f,d,m,g,v,y,S,w,I,R,b,T,A,L,C,E,F,G,B,P,M,O,x,k,N,H,U,D,W,V,X,Y,z,J,j,K,q,Q;return{setters:[function(c){t=c.e,e=c.f,n=c.V,i=c.R,o=c.h,r=c.a,s=c.t,a=c.c,l=c.i,u=c.S,h=c.j},function(t){c=t.cclegacy,p=t.Vec2,_=t.log,f=t.Size,d=t._decorator,m=t.Sprite,g=t.Label,v=t.Animation,y=t.randomRange,S=t.Component,w=t.sp,I=t.instantiate,R=t.game,b=t.Game,T=t.warn},function(t){A=t.A,L=t.D,C=t.I,E=t.u,F=t.c,G=t.s,B=t.l,P=t.w,M=t.C,O=t.a},function(t){x=t.a,k=t.C,N=t.j,H=t.f,U=t.h,D=t.i,W=t.A,V=t.d,X=t.e,Y=t._,z=t.b,J=t.c,j=t.g,K=t.F,q=t.R},function(t){Q=t.S}],execute:function(){var Z,$,tt,et,nt,it;c._RF.push({},"5da72LAUjtFmYOfEf6fJKud","LegendSlotEnum.global",void 0),function(t){t.EN="en-us",t.CN="zh-cn",t.TW="zh-tw"}(Z||(Z={})),function(t){t.UNKNOWN="",t.A="a",t.A_BLUR="a_blur",t.B="b",t.B_BLUR="b_blur",t.C="c",t.C_BLUR="c_blur",t.D="d",t.D_BLUR="d_blur",t.E="e",t.E_BLUR="e_blur",t.F="f",t.F_BLUR="f_blur",t.G="g",t.G_BLUR="g_blur",t.H="h",t.H_BLUR="h_blur",t.Y="Y",t.Y_BLUR="Y_blur",t.X="x",t.X_BLUR="x_blur",t.X_LONG="xl",t.SINGLE_WILD="wild_24",t.TRIPLE_WILD="wild_3row",t.LIGHTNING="effect",t.EMPTY="z"}($||($={})),function(t){t.IDLE="idle_game",t.NORMAL="normal_game",t.TURBO="turbo_game"}(tt||(tt={})),function(t){t.IDLE="idle",t.STARTING="start",t.ROLLING="rolling",t.ENDING="ending",t.HIGHLIGHT="highlight",t.DONE="done"}(et||(et={})),function(t){t.MINOR="minor",t.MEGA="mega",t.MAJOR="major"}(nt||(nt={})),c._RF.pop(),c._RF.push({},"f3443ZyP/ZA5JGklKAlM3vB","LegendSlotEvent.global",void 0),function(t){t.OPTIONS="options",t.SHOW="show"}(it||(it={})),c._RF.pop(),c._RF.push({},"7ca90WKLjdIfqClcxwg/aEF","LegendSlotHelper",void 0);var ot=function(e,n){var i=[];if(0==(null==e?void 0:e.length)&&0==(null==n?void 0:n.win))return i;if((null==e?void 0:e.length)>0)for(var o=0;o<e.length;o++){var r,s;i.push({symbols:[].concat(e[o].match),highlightBoard:rt([e[o]]),winningCoordinates:st([e[o]]),payout:e[o].payout,winAmount:e[o].winAmount,pattern_id:null==(r=e[o])?void 0:r.pattern_id,isAnyWin:null==(s=e[o])?void 0:s.isAnyWin})}if((null==n?void 0:n.win)>0&&i.push({symbols:Array(n.count).fill("y"),highlightBoard:at(n),winningCoordinates:lt(n),payout:n.win,winAmount:n.win,isAnyWin:!0,isScatterWin:!0}),i.length>1){var a=Array(t.NUM_OF_ROWS_HIGHLIGHT).fill(null).map((function(){return Array(t.NUM_OF_REELS).fill("")}));i.forEach((function(t){for(var e=0;e<t.highlightBoard.length;e++)for(var n=0;n<t.highlightBoard[e].length;n++)""!==t.highlightBoard[e][n]&&a[e][n]!==t.highlightBoard[e][n]&&(a[e][n]=t.highlightBoard[e][n])})),i.unshift({symbols:[],highlightBoard:a,winningCoordinates:[],payout:0,winAmount:0})}return i},rt=function(e){var n=Array(t.NUM_OF_ROWS_HIGHLIGHT).fill(null).map((function(){return Array(t.NUM_OF_REELS).fill("")}));return e.forEach((function(t){var e=0,i=0;t.path.replace(/\s/g,"").split(",").forEach((function(o){switch(o.charAt(0)){case"a":e=0;break;case"b":e=1;break;case"c":e=2}(i=parseInt(o.charAt(1))-1)<t.match.length&&(n[e][i]=t.match[i]?t.match[i]:"")}))})),n},st=function(t){var e=[];return t.forEach((function(t){var n=0,i=0;t.path.replace(/\s/g,"").split(",").forEach((function(o){switch(o.charAt(0)){case"a":n=0;break;case"b":n=1;break;case"c":n=2}(i=parseInt(o.charAt(1))-1)<t.match.length&&t.match[i]&&e.push(new p(n,i))}))})),e},at=function(e){var n=Array(t.NUM_OF_ROWS_HIGHLIGHT).fill(null).map((function(){return Array(t.NUM_OF_REELS).fill("")})),i=0,o=0;return e.path.replace(/\s/g,"").split(",").forEach((function(t){switch(t.charAt(0)){case"a":i=0;break;case"b":i=1;break;case"c":i=2}o=parseInt(t.charAt(1))-1,n[i][o]="y"})),n},lt=function(t){var e=[],n=0,i=0;return t.path.replace(/\s/g,"").split(",").forEach((function(t){switch(t.charAt(0)){case"a":n=0;break;case"b":n=1;break;case"c":n=2}i=parseInt(t.charAt(1))-1,e.push(new p(n,i))})),e},ut=function(t){if(!t||0==t.length)return 0;var e=t.some((function(t){return t.isAnyWin})),n="",i=-1/0;switch(t.forEach((function(t){var e;t.isAnyWin||t.payout>i&&(i=t.payout,n=null==(e=t.match)?void 0:e[0])})),n){case"a":case"b":return 1;case"c":case"d":case"e":return 2;case"f":case"g":case"h":return 3;default:return e?4:0}};c._RF.pop(),c._RF.push({},"539c83AD+JMJ6eeX+AoKlWY","LegendSlotGame.controller",void 0);var ht=function(e){function n(t){var n;return(n=e.call(this,t)||this)._model.IsLanguageSwitched=!0,n._model.Options=null,n}x(n,e);var i=n.prototype;return i.init=function(e){var n;_(t.LOG_TAG,"Init Game Options: ",e);var i,o=(i=e.language).includes("en")||i.includes("us")?Z.EN:i.includes("zh")||i.includes("cn")||i.includes("tw")?Z.CN:t.DEFAULT_LANGUAGE;this._model.IsLanguageSwitched=(null==(n=this._model.Options)?void 0:n.language)!=o,this._model.Options=e,this._model.Options.language=o},i.triggerOnReady=function(){var t,e;null==(t=(e=this._model.Options).onReady)||t.call(e)},i.triggerOnClose=function(){var t,e;null==(t=(e=this._model.Options).onClose)||t.call(e)},n}(k);c._RF.pop(),c._RF.push({},"7212b1dVJtBErBS40kpvOtU","LegendSlotGame.model",void 0);var ct=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).onIsLanguageSwitched=new N,e._options=null,e._isLanguageSwitched=null,e}return x(e,t),H(e,[{key:"Options",get:function(){return this._options},set:function(t){this._options!=t&&(this._options=t)}},{key:"IsLanguageSwitched",get:function(){return this._isLanguageSwitched},set:function(t){if(this._isLanguageSwitched!=t){var e=this._isLanguageSwitched;this._isLanguageSwitched=t,this.onIsLanguageSwitched.trigger(t,e)}}}]),e}(U);c._RF.pop(),c._RF.push({},"56794yIRilKj6yobnFyuLnx","LegendSlotTotem.controller",void 0);var pt=function(t){function e(e){return t.call(this,e)||this}x(e,t);var n=e.prototype;return n.setSize=function(t,e){this._model.size=new f(t,e)},n.setTotem=function(t){this._model.totem=t},e}(k);c._RF.pop(),c._RF.push({},"086789h1pJCS6roM358XuW0","LegendSlotTotem.model",void 0);var _t,ft=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).onSize=new N,e.onTotem=new N,e._size=f.ZERO,e._totem=$.UNKNOWN,e}return x(e,t),H(e,[{key:"size",get:function(){return this._size},set:function(t){if(this._size!=t){var e=this._size;this._size=t,this.onSize.trigger(t,e)}}},{key:"totem",get:function(){return this._totem},set:function(t){if(this._totem!=t){var e=this._totem;this._totem=t,this.onTotem.trigger(t,e)}}}]),e}(U);c._RF.pop(),c._RF.push({},"7d637d+ys9CyKCv6pkPk62I","LegendSlotTotem.view",void 0);var dt,mt=d.ccclass;d.property;!function(t){t.DEFAULT="default",t.HIGHLIGHT="highlight",t.HIGHLIGHT_A="a_highlight",t.HIGHLIGHT_B="b_highlight",t.HIGHLIGHT_Y="y_highlight",t.HIGHLIGHT_X="x_highlight",t.HIGHLIGHT_XL="xl_highlight",t.BLUR="blur"}(dt||(dt={}));var gt=mt(_t=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._imgTotem=void 0,e._lblMultiplier=void 0,e._savedResultTotem=void 0,e}x(n,t);var i=n.prototype;return i.createNewController=function(){return this.Model=new ft,new pt(this.Model)},i.onLoad=function(){t.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},i.init=function(t){this.Ctrl.setSize(t.width,t.height),this.Ctrl.setTotem(t.totem),this.setHighlight(!1)},i._setupProperty=function(){this._imgTotem=this.node.getChildByPath("imgTotem").getComponent(m),this._lblMultiplier=this.node.getChildByPath("lblMultiplier").getComponent(g),this._lblMultiplier.node.active=!1},i._setupEvent=function(){var t=this;this.Model.onSize.on((function(e,n){t._uiTrans.setContentSize(e)})),this.Model.onTotem.on((function(n,i){t._imgTotem.spriteFrame=e.Instance.getImgTotem(n)})),this._imgTotem.node.active=!0},i.setTotem=function(t,e,n){void 0===e&&(e=!0),this._savedResultTotem=t,e&&this.Ctrl.setTotem(t)},i.hideTotemMultiplier=function(){this._lblMultiplier.node.active=!1},i.setToSavedTotem=function(){this.Ctrl.setTotem(this._savedResultTotem)},i.playBlurAnim=function(){this.node.getComponent(v).play(dt.BLUR)},i.playDefaultAnim=function(){this.node.getComponent(v).play(dt.DEFAULT)},i.setHighlight=function(t){if(this._imgTotem.spriteFrame)if(t){var n="";n=this._imgTotem.spriteFrame.name.includes($.A)?dt.HIGHLIGHT_A:this._imgTotem.spriteFrame.name.includes($.B)?dt.HIGHLIGHT_B:this._imgTotem.spriteFrame.name.includes($.Y)?dt.HIGHLIGHT_Y:this._imgTotem.spriteFrame.name.includes($.X_LONG)?dt.HIGHLIGHT_XL:this._imgTotem.spriteFrame.name.includes($.X)?dt.HIGHLIGHT_X:dt.HIGHLIGHT,this.node.getComponent(v).play(n)}else this._imgTotem.spriteFrame.name.includes($.A)?this._imgTotem.spriteFrame=e.Instance.getImgTotem($.A):this._imgTotem.spriteFrame.name.includes($.B)?this._imgTotem.spriteFrame=e.Instance.getImgTotem($.B):this._imgTotem.spriteFrame.name.includes($.Y)?this._imgTotem.spriteFrame=e.Instance.getImgTotem($.Y):this._imgTotem.spriteFrame.name.includes($.X_LONG)?this._imgTotem.spriteFrame=e.Instance.getImgTotem($.X_LONG):this._imgTotem.spriteFrame.name.includes($.X)&&(this._imgTotem.spriteFrame=e.Instance.getImgTotem($.X)),this.node.getComponent(v).play(this._imgTotem.spriteFrame.name.includes("blur")?dt.BLUR:dt.DEFAULT)},n}(D))||_t;c._RF.pop(),c._RF.push({},"d6cf4PhWktDJb9E0rcJLRB3","LegendSlotReel.controller",void 0);var vt=function(t){function e(e){return t.call(this,e)||this}x(e,t);var n=e.prototype;return n.setResultTotems=function(t){this._model.ResultTotems=t},n.setRollState=function(t){this._model.RollState=t},n.setRollCount=function(t){this._model.RollCount=t},n.setXMultiplier=function(t){void 0===t&&(t=1),this._model.xMultiplier=t},n.addRollCount=function(t){void 0===t&&(t=1),this._model.RollCount=this._model.RollCount+t},n.setIsTurbo=function(t){this._model.IsTurbo=t},e}(k);c._RF.pop(),c._RF.push({},"a8a1ajqMdVHVKxeEKM3XvJV","LegendSlotReel.model",void 0);var yt,St=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).onResultTotem=new N,e._resultTotems=[],e._xMultiplier=0,e.onRollState=new N,e._rollState=et.IDLE,e.onRollCount=new N,e._rollCount=0,e.onIsTurbo=new N,e._isTurbo=null,e}return x(e,t),H(e,[{key:"ResultTotems",get:function(){return this._resultTotems},set:function(t){if(this._resultTotems!=t){var e=this._resultTotems;this._resultTotems=t,this.onResultTotem.trigger(t,e)}}},{key:"xMultiplier",get:function(){return this._xMultiplier},set:function(t){if(this._xMultiplier!=t){this._xMultiplier;this._xMultiplier=t}}},{key:"RollState",get:function(){return this._rollState},set:function(t){if(this._rollState!=t){var e=this._rollState;this._rollState=t,this.onRollState.trigger(t,e)}}},{key:"RollCount",get:function(){return this._rollCount},set:function(t){if(this._rollCount!=t){var e=this._rollCount;this._rollCount=t,this.onRollCount.trigger(t,e)}}},{key:"IsTurbo",get:function(){return this._isTurbo},set:function(t){if(this._isTurbo!=t){var e=this._isTurbo;this._isTurbo=t,this.onIsTurbo.trigger(t,e)}}}]),e}(U);c._RF.pop(),c._RF.push({},"ecee3SGo8NGSJE8QMn5GOvu","LegendSlotReel.view",void 0);var wt,It=d.ccclass;d.property;!function(t){t.IDLE="idle",t.START="reelStart",t.ROLLING="reelRolling",t.END="reelEnd",t.END_SMOOTH="reelEndSmooth"}(wt||(wt={}));var Rt=It(yt=function(o){function r(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o.call.apply(o,[this].concat(n))||this)._totems=[],t._animator=void 0,t.reelNo=-1,t}x(r,o);var s=r.prototype;return s.createNewController=function(){return this.Model=new St,new vt(this.Model)},s.onLoad=function(){o.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},s.init=function(t){this.reelNo=t.reelNo,this.Ctrl.setIsTurbo(!1)},s.update=function(t){},s._setupProperty=function(){for(var e=0;e<t.NUM_OF_TOTEMS_PER_REEL;e++){var n=this.node.getChildByPath("Totems/TotemItem"+(e+1)).getComponent(gt);n.node.active=!0,this._totems.push(n)}this._animator=this.node.getComponent(v)},s._setupEvent=function(){var e=this;this.Model.onResultTotem.on(this._rollEndHandler.bind(this)),this.Model.onRollCount.on(this._rollEndHandler.bind(this)),this.Model.onRollState.on((function(t,e){})),this.Model.onIsTurbo.on((function(n,i){e._animator.clips.forEach((function(i){e._animator.getState(i.name).speed=n?t.TURBO_SPEED_RATIO:1}))}))},s._rollEndHandler=function(){if(this.Model.ResultTotems&&0!=this.Model.ResultTotems.length){var e=this.Model.IsTurbo?t.REEL_ROLL_TIMES:t.REEL_ROLL_TIMES+this.reelNo;this.Model.RollState==et.ROLLING&&this.Model.RollCount>=e/(this.Model.IsTurbo?t.TURBO_SPEED_RATIO:1)&&this.playEndRollAnim()}},s.skipSpin=function(){var e=this;this.Ctrl.addRollCount(t.REEL_ROLL_TIMES+this.reelNo),this._animator.clips.forEach((function(n){e._animator.getState(n.name).speed=t.TURBO_SPEED_RATIO}))},s.isSameSymbolColumn=function(t,e){return t.every((function(t){return t===e}))},s.isSomeSameSymbolColumn=function(t,e){return t.some((function(t){return t===e}))},s.setResultTotems=function(t,e,n){this.Ctrl.setResultTotems(t),this.Ctrl.setXMultiplier(e)},s.isAllX=function(){return this.isSameSymbolColumn(this.Model.ResultTotems,"x")},s.setFinalTotem=function(t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!0),this.Model.ResultTotems&&0!=this.Model.ResultTotems.length){for(var i=[].concat(this.Model.ResultTotems),o=0;o<i.length;o++)this._totems[o+1].node.active=!0,this._totems[o+1].setTotem(i[o],n,this.Model.xMultiplier);t&&i.some((function(t){return t==$.X}))&&W.Instance.playOneShotSfx(e.Instance.sfxHitWildScatterSymbol)}},s.setResultTotem=function(t){this._totems[t].setToSavedTotem(),this._totems[t].playDefaultAnim()},s.hasSymbolOnPos=function(t,e){var n=!1;return(this.Model.ResultTotems[e]==t||null!=t&&""!=t&&this.Model.ResultTotems[e]==$.X)&&(n=!0),n},s.setHighlight=function(t,e){var n=this;t.length>0&&t.forEach((function(t){n._totems[t].setHighlight(e)}))},s.getState=function(){return this.Model.RollState},s.getTotems=function(){return this._totems},s.playIdle=function(){this.Ctrl.setResultTotems(null),this.Ctrl.setRollCount(0),this._animator.play(wt.IDLE),this.Ctrl.setRollState(et.IDLE)},s.playStartRollAnim=function(n){var i=this;void 0===n&&(n=!1),this._totems.forEach((function(t){t.hideTotemMultiplier()})),this.Ctrl.setIsTurbo(n),this._animator.clips.forEach((function(e){i._animator.getState(e.name).speed=n?t.TURBO_SPEED_RATIO:1})),this._animator.play(wt.START),this.Ctrl.setRollState(et.STARTING),W.Instance.playSfx(e.Instance.sfxReelSpinning,!1,null,this.node.uuid)},s.playRollAnim=function(){this._animator.play(wt.ROLLING),this.Ctrl.setRollState(et.ROLLING)},s.playEndRollAnim=function(){this._animator.play(wt.END_SMOOTH),this.Ctrl.setRollState(et.ENDING),this.setFinalTotem(!1,!1),W.Instance.getAudioSource(this.node.uuid)&&W.Instance.stopSfx(this.node.uuid,!1),W.Instance.playOneShotSfx(e.Instance.getReelLandingSfx(this.node.getSiblingIndex()))},s._randomGenerateSymbol=function(t,e){void 0===e&&(e=!1);var n=$.A;switch(t[Math.floor(y(0,t.length))]){case $.A:n=e?$.A_BLUR:$.A;break;case $.B:n=e?$.B_BLUR:$.B;break;case $.C:n=e?$.C_BLUR:$.C;break;case $.D:n=e?$.D_BLUR:$.D;break;case $.E:n=e?$.E_BLUR:$.E;break;case $.F:n=e?$.F_BLUR:$.F;break;case $.G:n=e?$.G_BLUR:$.G;break;case $.H:n=e?$.H_BLUR:$.H;break;case $.X:n=e?$.X_BLUR:$.X}return n},s.setRandomTotemImage=function(t){if(this.Model.RollState==et.ROLLING){var e=t-1,o=$.EMPTY;n.some((function(e){return e==t}))&&(o=this._randomGenerateSymbol(i[this.reelNo],!0)),e<this._totems.length&&(this._totems[e].setTotem(o),this._totems[e].playBlurAnim())}},s.updateTotemState=function(){this.Ctrl.addRollCount()},s.setDone=function(){this._animator.play(wt.IDLE),this.Ctrl.setRollState(et.DONE),this.Ctrl.setRollCount(0)},r}(D))||yt;c._RF.pop(),c._RF.push({},"59b78X7Y39M+ru3r2No1EVi","LegendSlotMachine.controller",void 0);var bt=function(t){function e(e){return t.call(this,e)||this}x(e,t);var n=e.prototype;return n.setPrevResult=function(t){this._model.PrevResult=t},n.setResult=function(t){this._model.Result=t},n.setIsSkipSpin=function(t){this._model.IsSkipSpin=t},e}(k);c._RF.pop(),c._RF.push({},"efb21lTMl1E4pYYLSHSCIo/","LegendSlotMachine.model",void 0);var Tt,At=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._prevResult=null,e._result=null,e.onIsSkipSpin=new N,e._isSkipSpin=null,e}return x(e,t),H(e,[{key:"PrevResult",get:function(){return this._prevResult},set:function(t){this._prevResult!=t&&(this._prevResult=t)}},{key:"Result",get:function(){return this._result},set:function(t){this._result!=t&&(this._result=t)}},{key:"IsSkipSpin",get:function(){return this._isSkipSpin},set:function(t){if(this._isSkipSpin!=t){var e=this._isSkipSpin;this._isSkipSpin=t,this.onIsSkipSpin.trigger(t,e)}}}]),e}(U);c._RF.pop(),c._RF.push({},"614afc/zyVCApP/f68TthSV","LegendSlotMachine.view",void 0);var Lt=d.ccclass,Ct=(d.property,Lt(Tt=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this)._reelFactory=void 0,t._reels=[],t._reelsView=null,t._finalResult=[],t._initDone=!1,t._tweenStopSpin=null,t._updateCounter=0,t._reelsToRoll=[],t._machineState=tt.IDLE,t}x(n,e);var i=n.prototype;return i.createNewController=function(){return this.Model=new At,new bt(this.Model)},i.onLoad=function(){e.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},i.init=function(){for(var e=0;e<t.NUM_OF_REELS;e++){var n=this._reelFactory.getItem(this._reelsView).getComponent(Rt),i={reelNo:e};n.node.emit("init",i),this._reels.push(n)}this._initDone=!0},i.setResult=function(e){_(t.LOG_TAG,"[Result]:",e),this.Ctrl.setResult(e)},i.setIsSkipSpin=function(e){_(t.LOG_TAG,"[IsSkipSpin]:"+e),this.Ctrl.setIsSkipSpin(e)},i.setMachineState=function(t){this._machineState=t,this._updateCounter=0},i.spin=function(t){this.setMachineState(tt.IDLE),this._reels.forEach((function(t){t.playIdle()})),this._stopHighlightAll(),t||this.setMachineState(tt.NORMAL),this._reels.forEach((function(e){e.playStartRollAnim(t)}))},i.stopSpin=function(){var e=V(X().mark((function e(n){var i,o,r,s=this;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(t.LOG_TAG,"Results:",this.Model.Result.slots),i=this._getSpinResult(this.Model.Result.slots),o=i[0],r=Array.from(this.Model.Result.wild_reels),this._reels.forEach((function(t,e){var i=1,a=0;r.length>0&&r[0].reel-1==e&&(i=r[0].multiplier,a=r[0].reel,r.shift()),t.setResultTotems(o[e],i,a),n&&s.setMachineState(tt.TURBO)})),_(t.LOG_TAG,"Results 2:",o),this._finalResult=o,e.next=8,E((function(){return!s.checkRolling()}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i._getSpinResult=function(t){for(var e=[],n=0;n<t.length;n++)for(var i=t[n],o=0;o<i.length;o++){var r=i[o];e[o]||(e[o]=[]);var s=r;e[o][n]=s}return[e]},i._getRandomSlotResult=function(){return[].concat(o)},i.showPaylineHighlight=function(){var t=V(X().mark((function t(e,n){return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._showHighLightNormal(e);case 1:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),i.stopPaylineHighlight=function(){this._stopHighlightAll()},i.showPaylineHighlightAndScatter=function(t,e){this._showHighLightNormal(t,!0)},i.update=function(t){switch(this._machineState){case tt.NORMAL:case tt.TURBO:}this._updateCounter+=t},i.skipSpin=function(){this._reels.forEach((function(t,e){t.skipSpin()}))},i._setupProperty=function(){this._reelFactory=this.node.getChildByPath("reelsFactory").getComponent(C),this._reelsView=this.node.getChildByPath("Mask/reels")},i._setupEvent=function(){var t=this;this.node.once("show",this._onShow,this),this.Model.onIsSkipSpin.on((function(e,n){var i;e&&(null==(i=t._tweenStopSpin)||i.skip(),t.skipSpin())}))},i._onShow=function(){var t=V(X().mark((function t(){var e=this;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E((function(){return e._initDone}));case 2:this._reels.forEach((function(t){t.node.emit("show")})),this._showPrevResult(),this.node.emit("ready");case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i._showPrevResult=function(){var e,n,i=null!=(null==(e=L.Instance.GameData.me)?void 0:e.slots),o=null==(n=L.Instance.GameData.me)?void 0:n.slots;i||(o=this._getRandomSlotResult()),_(t.LOG_TAG,"Previous round symbols: "+(i?"":"(Random)"),o);var r=this._getSpinResult(o)[0];_(t.LOG_TAG,"Result:",r);for(var s=0;s<r.length;s++){var a=L.Instance.GameData.me.wild_reels?L.Instance.GameData.me.wild_reels[s].multiplier:1;this._reels[s].setResultTotems(r[s],a),this._reels[s].setFinalTotem(!1)}},i.checkRolling=function(){for(var t=!1,e=0;e<this._reels.length;e++)this._reels[e].getState()!==et.DONE&&(t=!0);return t},i.convertFromRowReelToReelRow=function(t){for(var e=[],n=0;n<this._reels.length;n++)e[n]=[];for(var i=0;i<t.length;i++)for(var o=t[i],r=0;r<o.length;r++){var s=o[r];e[r].push(s)}return e},i._showHighLightNormal=function(e,n){var i=this.convertFromRowReelToReelRow(e);_(t.LOG_TAG,"Convert row-reel (server) > reel-row (client)",e,i);for(var o=0;o<this._reels.length;o++){for(var r=[0,1,2,3,4],s=[],a=this._reels[o].isAllX(),l=0;l<i[o].length;l++)if(this._reels[o].hasSymbolOnPos(i[o][l],l)){var u=r.indexOf(l+1,0);u>-1&&(r.splice(u,1),s.push(l+1))}s.length>0&&a&&(s=[1,2,3]),this._reels[o].setHighlight(r,!1),this._reels[o].setHighlight(s,!0)}},i._stopHighlightAll=function(){for(var t=0;t<this._reels.length;t++){this._reels[t].setHighlight([0,1,2,3,4],!1)}},n}(Q))||Tt);c._RF.pop(),c._RF.push({},"0da6fb1UptEiK9CdnZQR6xM","LegendSlotFreeGame.controller",void 0);var Et=function(t){function e(e){return t.call(this,e)||this}return x(e,t),e.prototype.setRemainingSpins=function(t){void 0===t&&(t=1),this._model.remainingSpins=t},e}(k);c._RF.pop(),c._RF.push({},"7c368osk0tL8aOZy7susiV4","LegendSlotFreeGame.model",void 0);var Ft,Gt=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._remainingSpins=0,e}return x(e,t),H(e,[{key:"remainingSpins",get:function(){return this._remainingSpins},set:function(t){if(this._remainingSpins!=t){this._remainingSpins;this._remainingSpins=t}}}]),e}(U);c._RF.pop(),c._RF.push({},"4b14bhq7OhNrbXYbjN/X44O","LegendSlotFreeGame.view",void 0);var Bt,Pt=d.ccclass;d.property;!function(t){t.START="freeGameStart",t.END="freeGameEnd",t.END_FADE="freeGameEndFade"}(Bt||(Bt={}));var Mt=Pt(Ft=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._startAnimator=void 0,e._startAnimatorImg=void 0,e._startAnimDone=!1,e._endAnimator=void 0,e._endAnimatorContainer=void 0,e._endAnimDone=!1,e._lblFreeSpinLeft=void 0,e._lblTotalWinnings=void 0,e._tweenWin=null,e._winRollingAudioId="",e}x(n,t);var i=n.prototype;return i.createNewController=function(){return this.Model=new Gt,new Et(this.Model)},i.onLoad=function(){t.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},i.init=function(t){},i._setupProperty=function(){this._startAnimator=this.node.getChildByPath("start").getComponent(v),this._startAnimatorImg=this.node.getChildByPath("start/imgTitle").getComponent(m),this._startAnimatorImg.node.active=!1,this._endAnimator=this.node.getChildByPath("end").getComponent(v),this._endAnimatorContainer=this.node.getChildByPath("end/container"),this._endAnimatorContainer.active=!1,this._lblFreeSpinLeft=this.node.getChildByPath("running/lblAmnt").getComponent(g),this._lblFreeSpinLeft.node.active=!1,this._lblTotalWinnings=this.node.getChildByPath("end/container/lblAmnt").getComponent(g)},i.playFreeGameAnim=function(){var t=this;W.Instance.playOneShotSfx(e.Instance.sfxFreeStart),this._startAnimDone=!1,this._startAnimator.play(Bt.START);var n=this._startAnimator.clips[0],i=this._endAnimator.clips;i[0],i[1];setTimeout((function(){t._startAnimDone=!0}),1e3*n.duration)},i.getStartAnimDoneState=function(){return this._startAnimDone},i.getEndAnimDoneState=function(){return this._endAnimDone},i.playFreeGameEndAnim=function(){var t=this;W.Instance.playOneShotSfx(e.Instance.sfxFreeEnd),this._lblFreeSpinLeft.node.active=!1,this._endAnimatorContainer.active=!0,this._endAnimDone=!1,this._lblTotalWinnings.string="0",this._endAnimator.play(Bt.END);var n=this._endAnimator.clips,i=n[0];n[1];setTimeout((function(){t._endAnimDone=!0}),1e3*i.duration)},i.playFreeGameEndFadeAnim=function(){var t=this;this._endAnimDone=!1,this._endAnimator.play(Bt.END_FADE);var e=this._endAnimator.clips,n=(e[0],e[1]);setTimeout((function(){t._endAnimDone=!0}),1e3*n.duration)},i.updateFreeSpinLeft=function(t){this.Ctrl.setRemainingSpins(t),this._lblFreeSpinLeft.node.active||(this._lblFreeSpinLeft.node.active=!0,this.showRemainingFreeSpin(!0))},i.showRemainingFreeSpin=function(t){void 0===t&&(t=!1),this._lblFreeSpinLeft.node.active=!0,this._lblFreeSpinLeft.string="Free Spins Left :"+(t?this.Model.remainingSpins:this.Model.remainingSpins-1)},i.setWinAmount=function(t,n){var i,o=this,l=this._lblTotalWinnings;this._winRollingAudioId=W.Instance.playSfx(e.Instance.sfxNumRolling,!0),null==(i=this._tweenWin)||i.kill(),this._tweenWin=F(0,0+t,a(t),(function(t){l.string=""+s(t.simpleFormat(2))}),(function(){W.Instance.getAudioSource(o._winRollingAudioId)&&W.Instance.stopSfx(o._winRollingAudioId),W.Instance.playOneShotSfx(r.Instance.sfxNumRollEnd),l.string=""+s((0+t).simpleFormat(2)),null==n||n()}))},i._setupEvent=function(){},n}(D))||Ft;c._RF.pop(),c._RF.push({},"873dd07oQ1FqY0ufwYeeAkR","LegendSlotHighlight.controller",void 0);var Ot=function(t){function e(e){return t.call(this,e)||this}return x(e,t),e}(k);c._RF.pop(),c._RF.push({},"85bf8fQg+VLKp9WrpA0R39J","LegendSlotHighlight.model",void 0);var xt,kt=function(t){function e(){return t.apply(this,arguments)||this}return x(e,t),e}(U);c._RF.pop(),c._RF.push({},"8308a2wNltMvpjfeqvvNQXR","LegendSlotHighlightItemAnim.view",void 0);var Nt,Ht=d.ccclass;d.property;!function(t){t.DEFAULT="play"}(Nt||(Nt={}));var Ut,Dt=Ht(xt=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._anim=void 0,e}x(e,t);var n=e.prototype;return n.onLoad=function(){this._setupProperty()},n._setupProperty=function(){this._anim=this.node.getChildByPath("imgAnim").getComponent(v)},n.show=function(t){t&&(this._anim.node.active=!0,this._anim.play(Nt.DEFAULT))},n.hide=function(){this._anim.stop(),this._anim.node.active=!1},e}(S))||xt;c._RF.pop(),c._RF.push({},"1fbcefuy/tLSbZgnC4S3ueK","LegendSlotHighlightItemSP.view",void 0);var Wt,Vt=d.ccclass;d.property;!function(t){t.DEFAULT="play"}(Wt||(Wt={}));var Xt,Yt,zt,Jt,jt=Vt(Ut=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._spine=null,e}x(n,t);var i=n.prototype;return i.onLoad=function(){this._setupProperty()},i._setupProperty=function(){this._spine=this.node.getChildByPath("spAnim").getComponent(w.Skeleton)},i.show=function(t,n,i){void 0===i&&(i=!0),t&&(this._spine.skeletonData=e.Instance.getTotemSpine(t),this._spine.premultipliedAlpha=!1,this._spine.setAnimation(0,n||Wt.DEFAULT,i),this._spine.node.active=!0)},i.hide=function(){this._spine.node.active=!1},n}(S))||Ut;c._RF.pop(),c._RF.push({},"9ba099qofRFpbriS2Y7sDgo","LegendSlotHighlight.view",void 0);var Kt,qt=d.ccclass,Qt=d.property;!function(t){t.START="spinification_start",t.LOOP_1="Loop_x1",t.LOOP_2="Loop_x2",t.LOOP_3="Loop_x3",t.LOOP_5="Loop_x5",t.LIGHTNING="animation",t.SHAKE="board_shake"}(Kt||(Kt={}));var Zt=(Xt=Qt(v),qt((Jt=Y((zt=function(n){function i(){for(var t,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))||this)._dbHighlightItems=null,t._lightning=null,t._animHighlightItems=null,t._wildHighlightItems=[],z(t,"boardAnimator",Jt,J(t)),t}x(i,n);var o=i.prototype;return o.createNewController=function(){return this.Model=new kt,new Ot(this.Model)},o.onLoad=function(){n.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},o.init=function(){},o._setupProperty=function(){this._dbHighlightItems=this.node.getChildByPath("db").getComponentsInChildren(jt),this._lightning=this.node.getChildByPath("lightning").getComponent(jt),this._animHighlightItems=this.node.getChildByPath("anim").getComponentsInChildren(Dt);for(var e=0;e<t.NUM_OF_REELS;e++){var n=this.node.getChildByPath("wild/reel"+(e+1)).getComponent(w.Skeleton);n.node.active=!1,this._wildHighlightItems.push(n)}},o._setupEvent=function(){},o.showOnce=function(t){if(0!=(null==t?void 0:t.length))if(this.hide(),this._lightning.show($.LIGHTNING,Kt.LIGHTNING,!1),this.boardAnimator.play(Kt.SHAKE),navigator.vibrate&&window.navigator.vibrate(100),this.isContainMultiplier(t,5))this._dbHighlightItems[7].show($.TRIPLE_WILD,Kt.LOOP_5),W.Instance.playOneShotSfx(e.Instance.sfxWild5);else for(var n=0;n<t.length;n++){var i=6+n,o=this.getWildLoop(t[n].multiplier);this._dbHighlightItems[i].show($.SINGLE_WILD,o.animName),W.Instance.playOneShotSfx(o.audioClip)}},o.show=function(t,e,n){},o.getWildLoop=function(t){var n,i;switch(t){case 1:n=Kt.LOOP_1,i=e.Instance.sfxWild1;break;case 2:n=Kt.LOOP_2,i=e.Instance.sfxWild2;break;case 3:n=Kt.LOOP_3,i=e.Instance.sfxWild3}return{animName:n,audioClip:i}},o.isContainMultiplier=function(t,e){for(var n=!1,i=0;i<t.length;i++)t[i].multiplier===e&&(n=!0);return n},o.hide=function(){this._dbHighlightItems.forEach((function(t){return t.hide()})),this._animHighlightItems.forEach((function(t){return t.hide()}))},o.playWildScatterSfx=function(n,i){for(var o=!1,r=0;r<t.NUM_OF_ROWS;r++)for(var s=0;s<(null==(a=n[r])?void 0:a.length);s++){var a;0,""!==n[r][s]&&i[r][s]==$.X&&(o=!0)}o&&W.Instance.playOneShotSfx(e.Instance.sfxWinWild)},o.getNodesByCoordinates=function(e){var n=this;return e.map((function(e){var i=t.NUM_OF_REELS*e.x+e.y;return i<n._animHighlightItems.length?n._animHighlightItems[i].node:null}))},o.hideAllWildSpines=function(){this._wildHighlightItems.forEach((function(t){return t.node.active=!1}))},o.highlightFullWild=function(t){for(var e=[[],[],[],[],[]],n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)e[i].push(t[n][i]);e.forEach((function(t){for(var e=0;e<t.length;e++)t[e],$.X})),this._wildHighlightItems},i}(D)).prototype,"boardAnimator",[Xt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=zt))||Yt);c._RF.pop(),c._RF.push({},"df149c3W4VFv52av7TWLAv/","LegendSlotJackpotWin.controller",void 0);var $t=function(t){function e(e){return t.call(this,e)||this}return x(e,t),e}(k);c._RF.pop(),c._RF.push({},"0a5a2n+NX1AcrXQRoZUOh1u","LegendSlotJackpotWin.model",void 0);var te,ee=function(t){function e(){return t.apply(this,arguments)||this}return x(e,t),e}(U);c._RF.pop(),c._RF.push({},"952abPR8/pPuoHAe+0PBN12","LegendSlotJackpotWin.view",void 0);var ne=d.ccclass,ie=(d.property,ne(te=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._lblMinor=void 0,e._lblMega=void 0,e._lblMajor=void 0,e._tweenWin=null,e._winRollingAudioId="",e}x(e,t);var n=e.prototype;return n.createNewController=function(){return this.Model=new ee,new $t(this.Model)},n.onLoad=function(){t.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},n.init=function(t){},n._setupProperty=function(){this._lblMinor=this.node.getChildByPath("minor/lblAmnt").getComponent(g),this._lblMega=this.node.getChildByPath("mega/lblAmnt").getComponent(g),this._lblMajor=this.node.getChildByPath("major/lblAmnt").getComponent(g),this._lblMinor.string=""+s(this._getRandomNumber(6e5,62e4).simpleFormat(2)),this._lblMega.string=""+s(this._getRandomNumber(67e4,68e4).simpleFormat(2)),this._lblMajor.string=""+s(this._getRandomNumber(6e5,62e4).simpleFormat(2))},n._setupEvent=function(){},n._getRandomNumber=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},n._getRandomJackpotOption=function(){var t=[];for(var e in nt)nt.hasOwnProperty(e)&&t.push(nt[e]);return t[Math.floor(Math.random()*t.length)]},n.updateAmount=function(t,e){switch(t=this._getRandomNumber(1,50),this._getRandomJackpotOption()){case nt.MINOR:this.setWinAmount(t,this._lblMinor);break;case nt.MEGA:this.setWinAmount(t,this._lblMega);break;case nt.MAJOR:this.setWinAmount(t,this._lblMajor)}},n.setWinAmount=function(t,e,n){var i,o=this,u=parseFloat(l(e.string).replace(/,/g,""));null==(i=this._tweenWin)||i.kill(),this._tweenWin=F(u,u+t,a(t),(function(t){e.string=""+s(t.simpleFormat(2))}),(function(){W.Instance.getAudioSource(o._winRollingAudioId)&&W.Instance.stopSfx(o._winRollingAudioId),W.Instance.playOneShotSfx(r.Instance.sfxNumRollEnd),e.string=""+s((u+t).simpleFormat(2)),null==n||n()}))},e}(D))||te);c._RF.pop(),c._RF.push({},"213c8Tu1CFJeKdCPKQAkcqt","LegendSlotWinLine.controller",void 0);var oe=function(t){function e(e){return t.call(this,e)||this}return x(e,t),e}(k);c._RF.pop(),c._RF.push({},"9b1e21qc9BFhJQWz7OWIf5C","LegendSlotWinLine.model",void 0);var re,se=function(t){function e(){return t.apply(this,arguments)||this}return x(e,t),e}(U);c._RF.pop(),c._RF.push({},"1a7a1P+wvtLXbmLABz3C/7O","LegendSlotWinLineItem.view",void 0);var ae,le=d.ccclass;d.property;!function(t){t.SHOW="show",t.HIDE="hide"}(ae||(ae={}));var ue,he=le(re=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._anim=void 0,e}x(e,t);var n=e.prototype;return n.onLoad=function(){this._setupProperty()},n._setupProperty=function(){this._anim=this.node.getComponent(v)},n.show=function(){this._anim.play(ae.SHOW)},n.hide=function(){this._anim.play(ae.HIDE)},e}(S))||re;c._RF.pop(),c._RF.push({},"414c7Sj1epD/YTWlzcrGUTc","LegendSlotWinLine.view",void 0);var ce=d.ccclass,pe=(d.property,ce(ue=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._winLineItems=[],e}x(e,t);var n=e.prototype;return n.createNewController=function(){return this.Model=new se,new oe(this.Model)},n.onLoad=function(){t.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},n.init=function(){},n._setupProperty=function(){this._winLineItems=this.node.getComponentsInChildren(he)},n._setupEvent=function(){},n.show=function(t){this.hide();var e=t-1;e<this._winLineItems.length&&this._winLineItems[e].show()},n.hide=function(){this._winLineItems.forEach((function(t){t.hide()}))},e}(D))||ue);c._RF.pop(),c._RF.push({},"3978fl7BA1FvIbQmEs1hBH1","LegendSlotUI.controller",void 0);var _e=function(t){function e(e){return t.call(this,e)||this}return x(e,t),e}(k);c._RF.pop(),c._RF.push({},"b1346SBmnhAqYN2gleVyZbf","LegendSlotUI.model",void 0);var fe,de,me,ge,ve,ye,Se,we,Ie=function(t){function e(){return t.apply(this,arguments)||this}return x(e,t),e}(U);c._RF.pop(),c._RF.push({},"bc0bcs2JNpP6LfCXoXeTUBe","LegendSlotUI.view",void 0);var Re,be=d.ccclass,Te=d.property,Ae=(fe=Te(Ct),de=Te(Zt),me=Te(pe),be((ye=Y((ve=function(n){function i(){for(var t,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t=n.call.apply(n,[this].concat(i))||this,z(t,"machineView",ye,J(t)),z(t,"highlightView",Se,J(t)),z(t,"winLineView",we,J(t)),t.jackpotWinView=null,t.freeGameView=null,t._ui=null,t._initDone=!1,t._reponseReceived=!1,t._tweenPaylineHighlight=null,t._freebieToken=void 0,t._freeGame=!1,t._remainingFreeSpins=0,t}x(i,n);var o=i.prototype;return o.createNewController=function(){return this.Model=new Ie,new _e(this.Model)},o.onLoad=function(){n.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},o.init=function(t){var n=this,i=t,o=I(i.uiPrefab);o.setParent(this.node);var r={bundleName:"ui",language:i.language,onReady:function(){o.emit("show"),n._initDone=!0},onClose:function(t){},onGetUIView:function(t){n._ui=t},onGetGameRuleData:function(){return e.Instance.rulesPrefabs},onGetPaytableData:function(){return L.Instance.Paytable},onGetGameHistoryData:function(){return A.Instance.BetHistoryApiBaseUrl+"?apiUrl="+L.Instance.EnvData.apiUrl+"&token="+A.Instance.MemberToken+"&game="+L.Instance.EnvData.gameId}};o.emit("options",r)},o._setupProperty=function(){this.jackpotWinView=this.node.getChildByPath("jackpot").getComponent(ie),this.freeGameView=this.node.getChildByPath("freegame").getComponent(Mt)},o._setupEvent=function(){this.node.once("show",this._onShow,this),R.on(b.EVENT_SHOW,this._gameShow,this),R.on(b.EVENT_HIDE,this._gameHide,this)},o._gameShow=function(){var e=(Date.now()-L.Instance.GameGoesIntoBgTimestamp)/1e3;_(t.LOG_TAG,"Game resumed from background, duration="+e+"s"),this.syncGameData()},o._gameHide=function(){L.Instance.GameGoesIntoBgTimestamp=Date.now(),_(t.LOG_TAG,"Game goes into background, time="+L.Instance.GameGoesIntoBgTimestamp)},o._onShow=function(){var e=V(X().mark((function e(){var n,i,o,r,s,a=this;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E((function(){return a._initDone&&null!=a.UI}));case 2:r=[(null==(n=L.Instance.Payline)||null==(i=n.patterns)?void 0:i.length)||1],s=(null==(o=L.Instance.GameData.me)?void 0:o.bet_amount_list)||[0],this.UI.setBetData(r,s,r[0],s[0]),this.UI.setIsDemoMode(L.Instance.GameData.me.isDemo),this.UI.setPlayerId(L.Instance.PlayerData.displayName),this.UI.setBalance(L.Instance.PlayerData.balance),this.UI.setBetState(u.READY_BET),this.UI.setHasBonus(t.HAS_BONUS_FEATURE),this.UI.bindEvent("start_play",this.onStartPlay.bind(this)),this.UI.bindEvent("skip_play",this.onSkipPlay.bind(this)),this.UI.bindEvent("toggle_audio",this.onToggleAudio.bind(this)),this.UI.bindEvent("toggle_turbo",this.onToggleTurbo.bind(this)),this.UI.bindEvent("bet_changed",this.onBetChanged.bind(this)),this.highlightView.hide(),this.winLineView.hide(),this.node.emit("ready");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.syncGameData=function(){var e=V(X().mark((function e(){var n;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.Instance.sync(L.Instance.EnvData.gameId);case 2:if(!((n=e.sent)instanceof Error)){e.next=7;break}return T(t.LOG_TAG,"play errors:",n),this.UI.showAlertMessage("Error","Something went wrong."),e.abrupt("return");case 7:if(_(t.LOG_TAG,"Sync game data: ",n),this.UI.getBetState()==u.READY_BET){e.next=10;break}return e.abrupt("return");case 10:L.Instance.PlayerData.balance!=n.balance&&(L.Instance.PlayerData.balance=n.balance,this.UI.setBalance(n.balance),this.UI.showAlertMessage("Notice","Your balance refreshed!"));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.getIsTriggerBonus=function(t){var e;return null!=(null==(e=t.bonus)?void 0:e.token)},o.onStartPlay=function(){var e=V(X().mark((function e(n){var i,o,r,s;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.UI.stopBalance(),this.validateAllowPlay(n)){e.next=3;break}return e.abrupt("return");case 3:return o=G(L.Instance.PlayerData.balance,n.totalBet),this.UI.setBalance(o),this._reponseReceived=!1,this.UI.setBetState(u.PLAYING),this.machineView.setIsSkipSpin(!1),null==(i=this._tweenPaylineHighlight)||i.kill(),this.machineView.stopPaylineHighlight(),this.highlightView.hide(),this.winLineView.hide(),this.machineView.spin(this.UI.getIsTurbo()),this.highlightView.hideAllWildSpines(),!this._freeGame||this._remainingFreeSpins<=0?this._freebieToken="":this.freeGameView.showRemainingFreeSpin(),r={bet_amount:n.betAmount,base_multiplier:1,multiplier:1,bet_line:n.betLines,freebieToken:this._freebieToken},L.Instance.EnvData.isActiveDemo&&L.Instance.EnvData.demoAccount.isCheatMode&&(r=j({},r,{cheatMode:!this._freeGame})),e.next=19,A.Instance.play(L.Instance.EnvData.gameId,r);case 19:if(!((s=e.sent)instanceof Error)){e.next=24;break}return T(t.LOG_TAG,"play errors:",s),this.UI.showAlertMessage("Error","Something went wrong."),e.abrupt("return");case 24:return this._reponseReceived=!0,this.machineView.setResult(s),this.UI.setCurrentBetData(n.totalBet),this.UI.setGameId(s.extra.game_roundId),this.UI.setBetState(u.STOPPING),e.next=31,this.machineView.stopSpin(this.UI.getIsTurbo());case 31:return this.UI.setBetState(u.STOPPED),e.next=34,this._waitForPayout(s,n.totalBet);case 34:return e.next=36,this._waitForBonus(s);case 36:return e.next=38,this._waitForBigWin(s);case 38:return e.next=40,this._waitForBalance(s);case 40:return e.next=42,this._waitForFreeGame(s);case 42:this.UI.setBetState(u.READY_BET);case 43:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.validateAllowPlay=function(e){return this.UI.getBetState()!=u.READY_BET?(_(t.LOG_TAG,"Unable to play, due to incorrect bet state "+u[this.UI.getBetState()]),!1):!(L.Instance.PlayerData.balance<=0||e.totalBet<=0||L.Instance.PlayerData.balance<e.totalBet)||(_(t.LOG_TAG,"Unable to play, due to insufficient. Balance:"+L.Instance.PlayerData.balance+", TotalBet:"+e.totalBet),this.UI.showAlertMessage("Notice","Insufficient balance."),!1)},o._waitForPayout=function(){var n=V(X().mark((function n(i,o){var r,s,a,l,u,h,c,p,f,d,m,g,v=this;return X().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(_(t.LOG_TAG,"waitForPayout"),r=i.total_win>0,s=i.total_win,a=0==s,this.UI.accumulateWinLose(r?s:-o),!r){n.next=25;break}return this.jackpotWinView.updateAmount(100,nt.MAJOR),this.UI.showPayoutMessage(r,s,(function(){a=!0})),null==(l=this._tweenPaylineHighlight)||l.kill(),u=ot(i.matches,i.scatters),h=[],i.matches.forEach((function(t){h.push(t.pattern_id)})),c=0,i.scatters&&(c=(null==(p=i.scatters)?void 0:p.win)>0?1:0),f=!0,this.highlightView.showOnce(i.wild_reels),d=function(t,n){var o=t.symbols.filter((function(t){return null!==t}));e.Instance.getImgTotems(o).length>0?v.machineView.showPaylineHighlight(t.highlightBoard,[t.pattern_id]):c?v.machineView.showPaylineHighlightAndScatter(t.highlightBoard,h):v.machineView.showPaylineHighlight(t.highlightBoard,h),v.highlightView.show(t.highlightBoard,i.slots,i.wild_reels),v.winLineView.show(t.pattern_id),f&&(f=!1,v.highlightView.playWildScatterSfx(t.highlightBoard,i.slots))},(m=u.length-1)>0?this._tweenPaylineHighlight=B(0,m,t.PAYLINE_HIGHLIGHT_DURATION,-1,(function(t){d(u[t])})):d(u[0]),g=e.Instance.getWinTierSfx(ut(i.matches)),W.Instance.playOneShotSfx(g),n.next=23,P(.5);case 23:return n.next=25,this._updateBonus(i,u);case 25:return n.next=27,E((function(){return a}));case 27:case"end":return n.stop()}}),n,this)})));return function(t,e){return n.apply(this,arguments)}}(),o._updateBonus=function(){var n=V(X().mark((function n(i,o){var r,s,a,l,u=this;return X().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!1,s=this.getIsTriggerBonus(i),a=s?t.MAX_BONUS:i.bonusLevel,i.matches.length,_(t.LOG_TAG,"updateStep steps: "+a+" isTriggerBonus: "+s),l=[],o.forEach((function(t){if(t.winningCoordinates.length>0){var e=u.highlightView.getNodesByCoordinates(t.winningCoordinates);e.length>0&&l.push(e[e.length-1])}})),!s){n.next=13;break}return W.Instance.playOneShotSfx(e.Instance.sfxTriggerBonus),n.next=11,P(1);case 11:return n.next=13,E((function(){return r}));case 13:case"end":return n.stop()}}),n,this)})));return function(t,e){return n.apply(this,arguments)}}(),o._waitForBonus=function(){var n=V(X().mark((function n(i){var o,r,s,a;return X().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(_(t.LOG_TAG,"waitForBonus"),o=this.getIsTriggerBonus(i),this.UI.updateIsHitBonus(o),!o){n.next=17;break}return this.UI.hideBetPanel(),null==(r=this._tweenPaylineHighlight)||r.pause(),this.machineView.stopPaylineHighlight(),n.next=9,P(1);case 9:return n.next=11,A.Instance.bonus({bonusToken:i.bonus.token});case 11:return(a=n.sent)instanceof Error?(T(t.LOG_TAG,"bonus errors:",a),this.UI.showAlertMessage("Error","Something went wrong on claim bonus.")):(parseFloat(a.bonusDetails.value),W.Instance.pauseSfx(h.BGM),W.Instance.playSfx(e.Instance.bgmBonus,!0,null,h.BGM_BONUS),W.Instance.stopSfx(h.BGM_BONUS),W.Instance.resumeSfx(h.BGM)),this.UI.showBetPanel(),n.next=16,P(1);case 16:null==(s=this._tweenPaylineHighlight)||s.resume();case 17:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),o._waitForBigWin=function(){var e=V(X().mark((function e(n){var i,o,r=this;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(t.LOG_TAG,"waitForBigWin"),i=n.total_win,this.getIsTriggerBonus(n)&&(i+=n.bonus.value),o=this.UI.checkIsBigWin(i),_(t.LOG_TAG,"Total payout: "+i+", Is BigWin: "+o),o){e.next=7;break}return e.abrupt("return");case 7:return W.Instance.setVolume(h.BGM,0),e.next=10,new Promise((function(t){r.UI.showBigWin(i,r.UI.getBetOptions().autoPlayOptions.isAutoPlay,t)}));case 10:W.Instance.setVolume(h.BGM,1);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o._waitForBalance=function(){var e=V(X().mark((function e(n){var i,o;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(t.LOG_TAG,"waitForBalance"),i=n.balance,!this.getIsTriggerBonus(n)){e.next=7;break}return e.next=5,A.Instance.sync(L.Instance.EnvData.gameId);case 5:(o=e.sent)instanceof Error?T(t.LOG_TAG,"play errors:",o):(_(t.LOG_TAG,"Sync balance because trigger bonus: ",o),i=o.balance);case 7:this.UI.showBalance(i,(function(){L.Instance.PlayerData.balance=i}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o._waitForFreeGame=function(){var e=V(X().mark((function e(n){var i,o=this;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.freebie){e.next=25;break}if(this._freebieToken=n.freebie.token,!(this._freeGame&&this._remainingFreeSpins>0)){e.next=14;break}if(!(n.freebie.remaining_number_of_spins>this._remainingFreeSpins)){e.next=11;break}return this._remainingFreeSpins=n.freebie.remaining_number_of_spins,this.UI.setBetState(u.FREE_GAME_AUTO),this.freeGameView.playFreeGameAnim(),e.next=9,E((function(){return o.freeGameView.getStartAnimDoneState()}));case 9:e.next=12;break;case 11:this._remainingFreeSpins=n.freebie.remaining_number_of_spins;case 12:e.next=15;break;case 14:this._remainingFreeSpins=n.freebie.remaining_number_of_spins;case 15:if(this._freeGame){e.next=21;break}return this._freeGame=!0,this.UI.setBetState(u.FREE_GAME_AUTO),this.freeGameView.playFreeGameAnim(),e.next=21,E((function(){return o.freeGameView.getStartAnimDoneState()}));case 21:this._freeGame&&this._remainingFreeSpins,this.freeGameView.updateFreeSpinLeft(this._remainingFreeSpins),e.next=48;break;case 25:if(!n.unlocked_freebie){e.next=48;break}return e.next=28,P(1.5);case 28:return this.freeGameView.playFreeGameEndAnim(),e.next=31,E((function(){return o.freeGameView.getEndAnimDoneState()}));case 31:return this.freeGameView.setWinAmount(n.unlocked_freebie.win_amount),e.next=34,P(2);case 34:return this.freeGameView.playFreeGameEndFadeAnim(),e.next=37,E((function(){return o.freeGameView.getEndAnimDoneState()}));case 37:return this._freeGame=!1,this._remainingFreeSpins=n.unlocked_freebie.remaining_number_of_spins,this.UI.setBetState(u.FREE_GAME_AUTO),e.next=42,P(2);case 42:if(i=this.UI.checkIsBigWin(n.unlocked_freebie.win_amount),_(t.LOG_TAG,"Total payout: "+n.unlocked_freebie.win_amount+", Is BigWin: "+i),i){e.next=46;break}return e.abrupt("return");case 46:return e.next=48,new Promise((function(t){o.UI.showBigWin(n.unlocked_freebie.win_amount,o.UI.getBetOptions().autoPlayOptions.isAutoPlay,t)}));case 48:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.onSkipPlay=function(){if(this._reponseReceived)switch(this.UI.getBetState()){case u.PLAYING:case u.STOPPING:this.machineView.setIsSkipSpin(!0);break;case u.STOPPED:this.UI.stopPayoutMessage(),this.UI.stopBalance()}},o.onToggleAudio=function(t){W.Instance.IsSoundMute=!t},o.onToggleTurbo=function(t){},o.onBetChanged=function(t){},H(i,[{key:"UI",get:function(){return this._ui}}]),i}(D)).prototype,"machineView",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=Y(ve.prototype,"highlightView",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=Y(ve.prototype,"winLineView",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=ve))||ge);c._RF.pop(),c._RF.push({},"c5f34pWeENCVZRksyhxglFH","LegendSlotGame.view",void 0);var Le=d.ccclass;d.property,Le(Re=function(n){function i(){for(var t,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))||this)._container=null,t._cachePrefabMap=new Map,t._uiView=null,t._machineView=null,t._readyCount=0,t}x(i,n);var o=i.prototype;return o.createNewController=function(){return this.Model=new ct,new ht(this.Model)},o.onLoad=function(){n.prototype.onLoad.call(this),this._setupManager(),this._setupProperty(),this._setupComponent(),this._setupEvent()},o.init=function(){},o._setupManager=function(){},o._setupProperty=function(){this._container=this.node.getChildByName("Container"),this._uiView=this.node.getChildByPath("Container/Viewport/===UI-LAYER===/UIView").getComponent(Ae),this._machineView=this.node.getChildByPath("Container/Viewport/===GAME-LAYER===/MachineView").getComponent(Ct)},o._setupComponent=function(){this.node.addComponent(K)},o._setupEvent=function(){var e=this;this.node.on(it.OPTIONS,this._initGameOptions,this),this.node.on(it.SHOW,this._onPanelShow,this),this._uiView.node.once("ready",(function(){e._readyCount++})),this._machineView.node.once("ready",(function(){e._readyCount++})),this.Model.onIsLanguageSwitched.on((function(e,n){_(t.LOG_TAG,e,n)}))},o._initGameOptions=function(){var t=V(X().mark((function t(e){return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.Ctrl.init(e),t.next=3,this._setupGamePrefabs();case 3:return t.next=5,this._setupView();case 5:this.Ctrl.triggerOnReady();case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),o._setupGamePrefabs=function(){var n=V(X().mark((function n(){var i,o,r,s,a,l,u=this;return X().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.Model.IsLanguageSwitched){n.next=2;break}return n.abrupt("return");case 2:if(null==(i=e.Instance)||i.node.destroy(),o=this.Model.Options.bundleName,r="prefab/i18n/"+this.Model.Options.language+"/"+t.THIS_GAME_RESOURCE_PREFAB_NAME,s="prefab/i18n/"+this.Model.Options.language+"/"+t.THIS_GAME_LOCALIZE_PREFAB_NAME,q.Instance.isBundleLoaded(o)){n.next=9;break}return n.next=9,new Promise((function(t){q.Instance.loadBundle(o,(function(e,n){t()}))}));case 9:if(this._cachePrefabMap.has(r)&&this._cachePrefabMap.has(s)){n.next=14;break}return a=q.Instance.getBundleAsset(o,r,null,(function(t){u._cachePrefabMap.has(r)||u._cachePrefabMap.set(r,t)}),(function(t){t("Failed to load game resource prefab: ",t)})),l=q.Instance.getBundleAsset(o,s,null,(function(t){u._cachePrefabMap.has(s)||u._cachePrefabMap.set(s,t)}),(function(t){t("Failed to load game localize prefab: ",t)})),n.next=14,Promise.all([a,l]);case 14:I(this._cachePrefabMap.get(r)).parent=this.node,I(this._cachePrefabMap.get(s)).parent=this.node;case 18:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),o._setupView=function(){var t=V(X().mark((function t(){var n=this;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return W.Instance.playSfx(e.Instance.bgm,!0,null,h.BGM),this._uiView.node.emit("init",this.Model.Options),this._machineView.node.emit("init"),this._uiView.node.emit("show"),this._machineView.node.emit("show"),t.next=7,E((function(){return 2==n._readyCount}));case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.closeGame=function(){this._onPanelClose()},o._onPanelShow=function(){this._container.active=!0},o._onPanelClose=function(){_(t.LOG_TAG,"Closing "+this.Model.Options.bundleName+" system"),this._container.active=!1,this.Ctrl.triggerOnClose(),this.destroy()},i}(D));c._RF.pop(),c._RF.push({},"6c512ayHYhIr7soQBZScsZk","LegendSlotTemplate.controller",void 0);var Ce=function(t){function e(e){return t.call(this,e)||this}return x(e,t),e.prototype.changeName=function(t){this._model.name=t},e}(k);c._RF.pop(),c._RF.push({},"06191pCHstKmoBGz3c4KfYY","LegendSlotTemplate.model",void 0);var Ee,Fe,Ge,Be,Pe=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).onName=new N,e._name="",e}return x(e,t),H(e,[{key:"name",get:function(){return this._name},set:function(t){if(this._name!=t){var e=this._name;this._name=t,this.onName.trigger(t,e)}}}]),e}(U);c._RF.pop(),c._RF.push({},"7e78fKN4/ZAhaz/PKy4BX6I","LegendSlotTemplate.view",void 0);var Me=d.ccclass;Ee=(0,d.property)(g),Me((Be=Y((Ge=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,z(e,"lblName",Be,J(e)),e}x(e,t);var n=e.prototype;return n.createNewController=function(){return this.Model=new Pe,new Ce(this.Model)},n.onLoad=function(){t.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},n.init=function(t){this.Ctrl.changeName("I changed name.")},n.start=function(){var t=V(X().mark((function t(){return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._setupView();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n._setupProperty=function(){},n._setupEvent=function(){var t=this;this.Model.onName.on((function(e,n){console.log(e,n),t.lblName.string=e}))},n._setupView=function(){var t=V(X().mark((function t(){return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.Ctrl.changeName("Hello World!");case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e}(D)).prototype,"lblName",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=Ge));c._RF.pop(),c._RF.push({},"c3bc7iVI5tEoqrgJI07cXUr","LegendSlotBonusProgress.controller",void 0);var Oe=function(t){function e(e){return t.call(this,e)||this}x(e,t);var n=e.prototype;return n.setMaxStep=function(t){this._model.MaxStep=t},n.setStep=function(t){this._model.Step=t},n.getProgress=function(){return this._model.Step/(this._model.MaxStep>0?this._model.MaxStep:1)},n.isEmpty=function(){return this.getProgress()<=0},n.isFull=function(){return this.getProgress()>=1},e}(k);c._RF.pop(),c._RF.push({},"40211S35uxPU5yQRlP8YXYh","LegendSlotBonusProgress.model",void 0);var xe,ke,Ne,He,Ue=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._maxStep=0,e.onStep=new N,e._step=-1,e}return x(e,t),H(e,[{key:"MaxStep",get:function(){return this._maxStep},set:function(t){this._maxStep!=t&&(this._maxStep=t)}},{key:"Step",get:function(){return this._step},set:function(t){if(this._step!=t){var e=this._step;this._step=t,this.onStep.trigger(t,e)}}}]),e}(U);c._RF.pop(),c._RF.push({},"a017bGIHrJFLpLidvMVdX+/","LegendSlotBonusProgress.view",void 0);var De=d.ccclass;xe=(0,d.property)(M),De((He=Y((Ne=function(n){function i(){for(var t,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t=n.call.apply(n,[this].concat(i))||this,z(t,"collector",He,J(t)),t}x(i,n);var o=i.prototype;return o.createNewController=function(){return this.Model=new Ue,new Oe(this.Model)},o.onLoad=function(){n.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},o.init=function(){},o._setupProperty=function(){},o._setupEvent=function(){},o.setMaxStep=function(t){this.Ctrl.setMaxStep(t)},o.setStep=function(t){this.Ctrl.setStep(t)},o.updateStep=function(){var e=V(X().mark((function e(n,i,o,r){var s,a,l,u,h=this;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((s=n-this.Model.Step)<=0)){e.next=3;break}return e.abrupt("return");case 3:a=s,l=0;case 5:if(!(l<s)){e.next=13;break}return u=l<i.length?i[l]:null,this._playCollectVfx(u,o,(function(){_(t.LOG_TAG,"Collected +1 bonus step"),h.Ctrl.setStep(h.Model.Step+1),--a<=0&&(null==r||r())})),e.next=10,P(.3);case 10:l++,e.next=5;break;case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,i,o){return e.apply(this,arguments)}}(),o._playCollectVfx=function(t,n,i){W.Instance.playOneShotSfx(e.Instance.sfxBonusVfxAppear),this.collector.playEffect(t,n,(function(){W.Instance.playOneShotSfx(e.Instance.sfxAddBonusStep),null==i||i()}))},o.finishStep=function(){this.Ctrl.setStep(this.Model.MaxStep)},o.getStep=function(){return this.Model.Step},o.resetStep=function(){this.Ctrl.setStep(0)},i}(D)).prototype,"collector",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=Ne));c._RF.pop(),c._RF.push({},"81c3dhtP8RJpaR+4k6NBoGS","LegendSlotBonus.controller",void 0);var We=function(t){function e(e){return t.call(this,e)||this}x(e,t);var n=e.prototype;return n.setPayout=function(t){this._model.Payout=t},n.setMultiplier=function(t){this._model.Multiplier=t},n.setBetAmount=function(t){this._model.BetAmount=t},e}(k);c._RF.pop(),c._RF.push({},"e80b9b0/XxIcJp5h8d+DBPs","LegendSlotBonus.model",void 0);var Ve,Xe=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._payout=0,e._multiplier=0,e._betAmount=0,e}return x(e,t),H(e,[{key:"Payout",get:function(){return this._payout},set:function(t){this._payout!=t&&(this._payout=t)}},{key:"Multiplier",get:function(){return this._multiplier},set:function(t){this._multiplier!=t&&(this._multiplier=t)}},{key:"BetAmount",get:function(){return this._betAmount},set:function(t){this._betAmount!=t&&(this._betAmount=t)}}]),e}(U);c._RF.pop(),c._RF.push({},"bde5aALqjVBTaQ9yqES1Em6","LegendSlotBonus.view",void 0);var Ye,ze=d.ccclass;d.property;!function(t){t.DEFAULT="default",t.SHOW="show",t.HIDE="hide"}(Ye||(Ye={}));var Je;ze(Ve=function(n){function i(){for(var t,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))||this)._anim=null,t._lblPayout=null,t._tapToSkipCount=null,t._tapToCollect=null,t._autoCollect=null,t._lblCountdown=null,t._currentCountTween=null,t._autoCollectTimerTween=null,t._winRollingAudioId="",t._isTapCollect=!1,t}x(i,n);var o=i.prototype;return o.createNewController=function(){return this.Model=new Xe,new We(this.Model)},o.onLoad=function(){n.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},o.init=function(){},o._setupProperty=function(){this._anim=this.node.getComponent(v),this._lblPayout=this.node.getChildByPath("container/lblPayout").getComponent(g),this._tapToSkipCount=this.node.getChildByPath("container/tapToSkipCount"),this._tapToCollect=this.node.getChildByPath("container/tapToCollect"),this._autoCollect=this.node.getChildByPath("container/autoCollect"),this._lblCountdown=this.node.getChildByPath("container/autoCollect/lblCountdown").getComponent(g)},o._setupEvent=function(){},o.setPayout=function(t){this.Ctrl.setPayout(t)},o.setMultiplier=function(t){this.Ctrl.setMultiplier(t)},o.setBetAmount=function(t){this.Ctrl.setBetAmount(t)},o.show=function(){var n=V(X().mark((function n(i,o){var r=this;return X().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===i&&(i=!1),this._lblPayout.string="",this._tapToSkipCount.active=!1,this._tapToCollect.active=!1,this._autoCollect.active=!1,this._isTapCollect=!1,n.next=8,O(this._anim,Ye.SHOW);case 8:return this._tapToSkipCount.active=!0,this._winRollingAudioId=W.Instance.playSfx(e.Instance.sfxNumRolling,!0),this._currentCountTween=F(0,this.Model.Payout,a(this.Model.Payout),(function(t){r._lblPayout.string=t.simpleFormat(2)}),(function(){W.Instance.getAudioSource(r._winRollingAudioId)&&W.Instance.stopSfx(r._winRollingAudioId),W.Instance.playOneShotSfx(e.Instance.sfxNumRollEnd)})),n.next=13,this._currentCountTween.toPromise();case 13:return this._currentCountTween.kill(),this._currentCountTween=null,n.next=17,P(1);case 17:return this._tapToCollect.active=!0,this._autoCollect.active=i,i&&(this._lblCountdown.string=t.AUTO_COLLECT_BONUS_DURATION.toFixed(0),this._autoCollectTimerTween=F(t.AUTO_COLLECT_BONUS_DURATION,0,t.AUTO_COLLECT_BONUS_DURATION,(function(t){r._lblCountdown.string=t.toFixed(0)}),(function(){r.onTapToCollect()}))),n.next=22,E((function(){return r._isTapCollect}));case 22:return n.next=24,O(this._anim,Ye.HIDE);case 24:null==o||o();case 25:case"end":return n.stop()}}),n,this)})));return function(t,e){return n.apply(this,arguments)}}(),o.hide=function(){this._anim.play(Ye.DEFAULT)},o.onTapToSkipCount=function(){this._currentCountTween&&this._currentCountTween.skip(!0)},o.onTapToCollect=function(){var t;this._isTapCollect=!0,this._tapToCollect.active=!1,null==(t=this._autoCollectTimerTween)||t.kill(),this._autoCollect.active=!1},i}(D));c._RF.pop(),c._RF.push({},"faacfLQ9sFGd6xDGKyz2u/3","LegendSlotReelBoardWinSP.view",void 0);var je,Ke=d.ccclass;d.property;!function(t){t.WIN="win_anim"}(je||(je={}));var qe;Ke(Je=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._spine=null,e}x(e,t);var n=e.prototype;return n.onLoad=function(){this._setupProperty()},n._setupProperty=function(){this._spine=this.node.getComponent(w.Skeleton),this.playIdle()},n.playIdle=function(){this.node.active=!1},n.playWin=function(){this.node.active=!0,this._spine.setAnimation(0,je.WIN,!0)},e}(S));c._RF.pop(),c._RF.push({},"43aacPH99NNS7rcsilx9q+n","LegendSlotTreeSP.view",void 0);var Qe,Ze=d.ccclass;d.property;!function(t){t.DEFAULT="tree_loop",t.WIN="tree_win"}(Qe||(Qe={}));Ze(qe=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._spine=null,e}x(e,t);var n=e.prototype;return n.onLoad=function(){this._setupProperty()},n._setupProperty=function(){this._spine=this.node.getComponent(w.Skeleton),this.playIdle()},n.playIdle=function(){this._spine.setAnimation(0,Qe.DEFAULT,!0)},n.playWin=function(){this._spine.setAnimation(0,Qe.WIN,!1),this._spine.addAnimation(0,Qe.DEFAULT,!0)},e}(S));c._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/legend-slot', 'chunks:///legend-slot.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});