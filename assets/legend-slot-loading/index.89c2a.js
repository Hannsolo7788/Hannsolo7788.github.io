System.register("chunks:///legend-slot-loading.js",["cc","./CoreModelEvent-3de9f67c.js"],(function(){"use strict";var t,n,e,o,i,r,a,s,c,u,l,h,p,d,g,f,_,v,S,w,b,L,m,y,P,C;return{setters:[function(p){t=p.cclegacy,n=p.log,e=p._decorator,o=p.ProgressBar,i=p.Button,r=p.AudioClip,a=p.warn,s=p.Component,c=p.input,u=p.Input,l=p.KeyCode,h=p.instantiate},function(t){p=t.a,d=t.C,g=t.j,f=t.f,_=t.h,v=t.i,S=t._,w=t.b,b=t.c,L=t.F,m=t.A,y=t.d,P=t.e,C=t.R}],execute:function(){t._RF.push({},"8c97fO2TIxKKoUKN0mgOrhk","LegendSlotLoadingConst.global",void 0);var O,R,M="GameResource",F="GameLocalize",I="en-us",G="[LegendSlotLoading]";t._RF.pop(),t._RF.push({},"a8547PU0GFDMrQ9XKqv9NTX","LegendSlotLoadingEnum.global",void 0),function(t){t.EN="en-us",t.CN="zh-cn",t.TW="zh-tw"}(O||(O={})),t._RF.pop(),t._RF.push({},"001beTTX5NICLyIiQRlnwnc","LegendSlotLoadingEvent.global",void 0),function(t){t.OPTIONS="options",t.SHOW="show",t.CLOSE="close",t.PROGRESS="progress"}(R||(R={})),t._RF.pop(),t._RF.push({},"f7a6aPMs4FAML+QpBqwDJb/","LegendSlotLoadingGame.controller",void 0);var E=function(t){function e(n){var e;return(e=t.call(this,n)||this)._model.IsLanguageSwitched=!0,e._model.Options=null,e}p(e,t);var o=e.prototype;return o.init=function(t){var e;n(G,"Init Loading Options: ",t);var o,i=(o=t.language).includes("en")||o.includes("us")?O.EN:o.includes("zh")||o.includes("cn")||o.includes("tw")?O.CN:I;this._model.IsLanguageSwitched=(null==(e=this._model.Options)?void 0:e.language)!=i,this._model.Options=t,this._model.Options.language=i},o.triggerOnShow=function(){var t,n;null==(t=(n=this._model.Options).onShow)||t.call(n)},o.triggerOnClose=function(){var t,n;null==(t=(n=this._model.Options).onClose)||t.call(n)},o.triggerOnStartGame=function(){var t,n;null==(t=(n=this._model.Options).onStartGame)||t.call(n)},e}(d);t._RF.pop(),t._RF.push({},"b6bc10kvV5AsYKDP0kdwGh5","LegendSlotLoadingGame.model",void 0);var B=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).onIsLanguageSwitched=new g,n._options=null,n._isLanguageSwitched=null,n}return p(n,t),f(n,[{key:"Options",get:function(){return this._options},set:function(t){this._options!=t&&(this._options=t)}},{key:"IsLanguageSwitched",get:function(){return this._isLanguageSwitched},set:function(t){if(this._isLanguageSwitched!=t){var n=this._isLanguageSwitched;this._isLanguageSwitched=t,this.onIsLanguageSwitched.trigger(t,n)}}}]),n}(_);t._RF.pop(),t._RF.push({},"bce62LD/aNDy6iyRKLX1//9","LegendSlotLoading.controller",void 0);var N=function(t){function n(n){return t.call(this,n)||this}return p(n,t),n.prototype.setProgress=function(t){this._model.progress=t},n}(d);t._RF.pop(),t._RF.push({},"db5abRPSM9Doa5oGaHL1Kri","LegendSlotLoading.model",void 0);var k,x=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).onProgress=new g,n._progress=0,n}return p(n,t),f(n,[{key:"progress",get:function(){return this._progress},set:function(t){if(this._progress!=t){var n=this._progress;this._progress=t,this.onProgress.trigger(t,n)}}}]),n}(_);t._RF.pop(),t._RF.push({},"a7755Ep25BHE6dbVbNwMPW+","LegendSlotLoading.view",void 0);var A,V,K,T,z,D=e.ccclass,H=(e.property,D(k=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this)._pbLoading=null,n._btnStart=null,n}p(n,t);var e=n.prototype;return e.createNewController=function(){return this.Model=new x,new N(this.Model)},e.onLoad=function(){t.prototype.onLoad.call(this),this._setupProperty(),this._setupEvent()},e.init=function(t){this.Ctrl.setProgress(0)},e._setupProperty=function(){this._pbLoading=this.node.getChildByPath("Container/loading").getComponent(o),this._btnStart=this.node.getChildByPath("Container/btnStart").getComponent(i),this._btnStart.node.active=!1},e._setupEvent=function(){var t=this;this.Model.onProgress.on((function(n,e){t._pbLoading.progress=n,t._btnStart.node.active||1!=n||(t._pbLoading.node.active=!1,t._btnStart.node.active=!0,t.setStartButtonInteractable(!0))}))},e.setProgress=function(t){this.Ctrl.setProgress(t)},e.setStartButtonInteractable=function(t){this._btnStart.interactable=t},n}(v))||k);t._RF.pop(),t._RF.push({},"f09c785bENEDrTVAuUg+Lkv","LegendSlotLoadingGameResource",void 0);var Q,U,W,X,Y=e.ccclass,j=(A=(0,e.property)(r),Y(((z=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return n=t.call.apply(t,[this].concat(o))||this,w(n,"sfxBtnStart",T,b(n)),n}return p(n,t),n.prototype.onLoad=function(){n._instance=this.node.getComponent(n)},f(n,null,[{key:"Instance",get:function(){return this._instance||a("GameResource not found in the scene"),this._instance}}]),n}(s))._instance=void 0,T=S((K=z).prototype,"sfxBtnStart",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=K))||V);t._RF.pop(),t._RF.push({},"954a1A1qiRLkaYQ0xY+GBgO","LegendSlotLoadingGame.view",void 0);var q=e.ccclass;Q=(0,e.property)(H),q((X=S((W=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return n=t.call.apply(t,[this].concat(o))||this,w(n,"loadingView",X,b(n)),n._container=null,n._cachePrefabMap=new Map,n}p(e,t);var o=e.prototype;return o.createNewController=function(){return this.Model=new B,new E(this.Model)},o.onLoad=function(){t.prototype.onLoad.call(this),this._setupManager(),this._setupProperty(),this._setupComponent(),this._setupEvent()},o.init=function(){},o._setupManager=function(){},o._setupProperty=function(){this._container=this.node.getChildByName("Container")},o._setupComponent=function(){this.node.addComponent(L)},o._setupEvent=function(){var t=this;this.node.on(R.OPTIONS,this._initGameOptions,this),this.node.on(R.SHOW,this._onPanelShow,this),this.node.on(R.CLOSE,this._onPanelClose,this),this.node.on(R.PROGRESS,this._onProgressChanged,this),c.on(u.EventType.KEY_UP,(function(n){n.keyCode==l.SPACE&&t.onStartGame()}),this),this.Model.onIsLanguageSwitched.on((function(t,e){n(G,t,e)}))},o._initGameOptions=function(){var t=y(P().mark((function t(n){return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.Ctrl.init(n),t.next=3,this._setupGamePrefabs();case 3:return t.next=5,this._setupView();case 5:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}(),o._setupGamePrefabs=function(){var t=y(P().mark((function t(){var n,e,o,i,r,a,s=this;return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.Model.IsLanguageSwitched){t.next=2;break}return t.abrupt("return");case 2:if(null==(n=j.Instance)||n.node.destroy(),e=this.Model.Options.bundleName,o="prefab/i18n/"+this.Model.Options.language+"/"+M,i="prefab/i18n/"+this.Model.Options.language+"/"+F,C.Instance.isBundleLoaded(e)){t.next=9;break}return t.next=9,new Promise((function(t){C.Instance.loadBundle(e,(function(n,e){t()}))}));case 9:if(this._cachePrefabMap.has(o)&&this._cachePrefabMap.has(i)){t.next=14;break}return r=C.Instance.getBundleAsset(e,o,null,(function(t){s._cachePrefabMap.has(o)||s._cachePrefabMap.set(o,t)}),(function(t){t("Failed to load game resource prefab: ",t)})),a=C.Instance.getBundleAsset(e,i,null,(function(t){s._cachePrefabMap.has(i)||s._cachePrefabMap.set(i,t)}),(function(t){t("Failed to load game localize prefab: ",t)})),t.next=14,Promise.all([r,a]);case 14:h(this._cachePrefabMap.get(o)).parent=this.node,h(this._cachePrefabMap.get(i)).parent=this.node;case 18:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o._setupView=function(){var t=y(P().mark((function t(){return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.loadingView.node.emit("init");case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.onStartGame=function(){m.Instance.playOneShotSfx(j.Instance.sfxBtnStart),this.loadingView.setStartButtonInteractable(!1),this.Ctrl.triggerOnStartGame()},o._onPanelShow=function(){n(G,"Showing "+this.Model.Options.bundleName+" system"),this._container.active=!0,this.Ctrl.triggerOnShow()},o._onPanelClose=function(){n(G,"Closing "+this.Model.Options.bundleName+" system"),this._container.active=!1,this.Ctrl.triggerOnClose(),this.destroy()},o._onProgressChanged=function(t){this.loadingView.setProgress(t)},e}(v)).prototype,"loadingView",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=W));t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/legend-slot-loading', 'chunks:///legend-slot-loading.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});